<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      width: 400px;
      padding: 0;
      background-color: #f8f9fa;
      color: #333;
    }

    .header {
      background: linear-gradient(135deg, #409EFF, #3675d6);
      color: white;
      padding: 15px;
      border-radius: 8px 8px 0 0;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .header h1 {
      font-size: 18px;
      font-weight: 500;
    }

    .tab-buttons {
      display: flex;
      background-color: #e9ecef;
      border-radius: 0 0 8px 8px;
    }

    .tab-buttons button {
      flex: 1;
      padding: 12px;
      border: none;
      background: transparent;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
      color: #6c757d;
    }

    .tab-buttons button.active {
      background: white;
      color: #409EFF;
      border-top: 2px solid #409EFF;
    }

    .container {
      padding: 20px;
      background: white;
      min-height: 300px;
    }

    textarea {
      width: 100%;
      height: 120px;
      margin-bottom: 15px;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      resize: vertical;
      font-size: 14px;
      transition: border-color 0.3s;
    }

    textarea:focus {
      outline: none;
      border-color: #409EFF;
      box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
    }

    .result {
      margin: 15px 0;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 6px;
      border-left: 4px solid #409EFF;
    }

    .result-title {
      font-weight: 600;
      margin-bottom: 8px;
      color: #495057;
    }

    .result-content {
      line-height: 1.6;
    }

    .result-item {
      margin-bottom: 5px;
    }

    .result-label {
      font-weight: 500;
      color: #495057;
    }

    .result-value {
      color: #212529;
      font-family: monospace;
    }

    button {
      width: 100%;
      padding: 12px;
      background: #409EFF;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
      font-weight: 500;
      transition: background 0.3s;
      box-shadow: 0 2px 4px rgba(64, 158, 255, 0.3);
    }

    button:hover {
      background: #337ecc;
    }

    button:active {
      transform: translateY(1px);
    }

    .secondary-btn {
      background: #6c757d;
      box-shadow: 0 2px 4px rgba(108, 117, 125, 0.3);
    }

    .secondary-btn:hover {
      background: #5a6268;
    }

    .btn-group {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .btn-group button {
      flex: 1;
      margin-top: 0;
    }

    #scheduleList {
      display: none;
      margin-top: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 6px;
    }

    #scheduleTitle {
      font-size: 16px;
      margin-bottom: 10px;
      color: #495057;
      font-weight: 600;
    }

    #scheduleItems {
      list-style: none;
      padding: 0;
    }

    #scheduleItems li {
      padding: 8px 0;
      border-bottom: 1px solid #e9ecef;
    }

    #scheduleItems li:last-child {
      border-bottom: none;
    }

    .empty-state {
      text-align: center;
      padding: 20px 0;
      color: #6c757d;
    }

    .empty-state h2 {
      margin-bottom: 10px;
      color: #495057;
    }

    .upload-section {
      margin: 20px 0;
      text-align: center;
    }

    .file-input-wrapper {
      position: relative;
      display: inline-block;
      overflow: hidden;
      margin-bottom: 15px;
    }

    .file-input-wrapper input[type=file] {
      position: absolute;
      left: 0;
      top: 0;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }

    .uploaded-content {
      margin-top: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 6px;
      text-align: left;
      max-height: 200px;
      overflow-y: auto;
      white-space: pre-wrap;
      font-family: monospace;
      font-size: 12px;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }
  </style>
</head>
<body>
<div class="header">
  <h1>工具箱 Utility</h1>
</div>

<div class="tab-buttons">
  <button id="featureOneBtn" class="active">功能一</button>
  <button id="featureTwoBtn">功能二</button>
</div>

<div class="container">
  <!-- 功能一内容（原页面内容） -->
  <div id="featureOne" class="tab-content active">
    <textarea id="inputText" placeholder="请粘贴需要处理的文本..."></textarea>

    <div class="result">
      <div class="result-title">提取结果</div>
      <div class="result-content">
        <div class="result-item">
          <span class="result-label">账号：</span>
          <span id="username" class="result-value">-</span>
        </div>
        <div class="result-item">
          <span class="result-label">密码：</span>
          <span id="password" class="result-value">-</span>
        </div>
      </div>
    </div>

    <button id="extractAndFill">提取并自动填充</button>
    <button id="getSchedule" class="secondary-btn">获取课程列表</button>

    <div id="scheduleList">
      <div id="scheduleTitle"></div>
      <ul id="scheduleItems"></ul>
    </div>
  </div>

  <!-- 功能二内容 -->
  <div id="featureTwo" class="tab-content">
    <div class="upload-section">
      <h2>表格处理功能</h2>
      <p>请上传Excel文件进行处理</p>

      <div class="btn-group">
        <button id="downloadTemplate">下载文件模板</button>
      </div>

      <div class="file-input-wrapper">
        <button class="secondary-btn">选择Excel文件</button>
        <input type="file" id="excelFile" accept=".xlsx,.xls">
      </div>
      <p id="fileName" style="margin-top: 10px; font-size: 14px; color: #6c757d;"></p>
    </div>

    <div id="fileContent" class="uploaded-content" style="display: none;"></div>
  </div>
</div>

<script src="popup.js"></script>

<script>
  // 添加功能切换逻辑
  document.getElementById('featureOneBtn').addEventListener('click', function() {
    document.getElementById('featureOneBtn').classList.add('active');
    document.getElementById('featureTwoBtn').classList.remove('active');
    document.getElementById('featureOne').classList.add('active');
    document.getElementById('featureTwo').classList.remove('active');
  });

  document.getElementById('featureTwoBtn').addEventListener('click', function() {
    document.getElementById('featureTwoBtn').classList.add('active');
    document.getElementById('featureOneBtn').classList.remove('active');
    document.getElementById('featureTwo').classList.add('active');
    document.getElementById('featureOne').classList.remove('active');
  });

  // 下载模板功能
  document.getElementById('downloadTemplate').addEventListener('click', function() {
    // 创建一个隐藏的a标签用于下载
    const a = document.createElement('a');
    a.href = 'talk_template.xlsx'; // 相对路径，Chrome扩展会正确解析
    a.download = 'talk_template.xlsx';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  });

  // 文件上传处理
  document.getElementById('excelFile').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
      document.getElementById('fileName').textContent = '已选择: ' + file.name;

      const reader = new FileReader();
      reader.onload = function(e) {
        // 这里只是简单地将文件内容转为文本显示
        // 实际项目中你可能需要使用xlsx库来解析Excel文件
        const content = e.target.result;
        const contentDisplay = document.getElementById('fileContent');
        contentDisplay.textContent = '文件已上传，大小: ' + (content.byteLength || content.length) + ' 字节';
        contentDisplay.style.display = 'block';
      };

      // 读取为ArrayBuffer，便于后续处理
      reader.readAsArrayBuffer(file);
    } else {
      document.getElementById('fileName').textContent = '';
      document.getElementById('fileContent').style.display = 'none';
    }
  });
</script>
</body>
</html>
